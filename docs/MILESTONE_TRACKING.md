# 线索管理系统 - 里程碑跟踪文档

> **项目名称**: 线索数据包管理系统  
> **文档版本**: 1.0  
> **创建时间**: 2025-01-18  
> **最后更新**: 2025-01-18

---

## 📊 当前状态

```
✅ M0 已完成 (2025-01-18)
🔄 M1 进行中 (0% - 刚开始)
⏳ M2 待开始
⏳ M3 待开始
⏳ M4 待开始
```

---

## 📈 整体进度

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100%

M0 ████████████████████ 100%  ✅
M1 ░░░░░░░░░░░░░░░░░░░░   0%  🔄
M2 ░░░░░░░░░░░░░░░░░░░░   0%  ⏳
M3 ░░░░░░░░░░░░░░░░░░░░   0%  ⏳
M4 ░░░░░░░░░░░░░░░░░░░░   0%  ⏳
```

---

## ✅ M0：Figma 低保真原型

**目标**: 完成产品设计和需求文档

**状态**: ✅ 已完成  
**完成时间**: 2025-01-18

### 交付物清单

#### 1. PRD 文档 ✅
- [x] 产品背景与目标
- [x] 用户角色和使用场景
- [x] 系统信息架构（IA）
- [x] 4 个核心页面需求定义
- [x] 16 个标签规则详细说明
- [x] 成本/产值/毛利计算公式
- [x] 接通率默认值（N/O1-O6）
- [x] 状态推进逻辑
- [x] 数据模型设计（7张表）

**文档位置**: `docs/PRD.md`

#### 2. 页面原型 ✅
- [x] 首页看板原型
  - 4个统计卡片
  - 数据包矩阵（8列栅格）
  - 时间筛选器
- [x] 数据包详情页原型
  - 包信息展示
  - 标签统计看板
  - 任务列表
  - 新建任务面板
- [x] 数据包登记表原型
  - 登记表单
  - 数据包列表
- [x] 线索需求计算器原型
  - 业务参数输入
  - 数据剩余展示
  - 7天模拟表

#### 3. 数据模型设计 ✅
- [x] users - 用户表
- [x] lead_packages - 数据包表（N~O15 层级字段）
- [x] dial_tasks - 任务表
- [x] calls - 通话记录表
- [x] call_tags - 通话标签表
- [x] package_tag_summary - 包级标签汇总表
- [x] metrics_summary - 指标汇总表

#### 4. 业务规则定义 ✅
- [x] 16 个标签分组（成功类/可跟进类/无效类/未处理类）
- [x] 成本计算：1元/条
- [x] 产值计算：AS1×170 + AS2×100
- [x] 接通率默认值（N:20%, O1/O2:12%, O3/O4:8%, O5/O6:5%）
- [x] 状态推进逻辑（未接通→下一层）

### 验收标准 ✅

- [x] PRD 文档完整，涵盖所有业务需求
- [x] 页面原型清晰，交互流程明确
- [x] 数据库表结构设计完整
- [x] 业务规则定义准确
- [x] 里程碑规划清晰（M0-M4）

---

## 🔄 M1：Cursor 骨架

**目标**: 搭建前后端基础架构，实现静态页面和基础 CRUD

**状态**: 🔄 进行中（0% - 刚开始）  
**开始时间**: 2025-01-18  
**预计完成**: 待定

### 核心原则

- ✅ 能跑起来（前后端可运行）
- ✅ 有基础数据流（创建/查询数据包）
- ❌ 不涉及复杂业务逻辑
- ❌ 不对接外部系统（外呼平台）

---

### 📱 前端任务（0/15）

#### 1. 项目搭建（0/6）

- [ ] React + Vite 项目初始化
  - [ ] 安装依赖（react, react-router-dom, axios, swr）
  - [ ] 配置 Vite (端口 3002)
  - [ ] 配置代理（指向后端 5002）
- [ ] TailwindCSS 配置
  - [ ] 安装 tailwindcss
  - [ ] 配置 tailwind.config.js
  - [ ] 设置主题颜色
- [ ] 路由配置
  - [ ] 安装 react-router-dom
  - [ ] 配置路由表（4个页面）
  - [ ] 实现路由守卫（登录检查）
- [ ] 基础 Layout
  - [ ] Header 组件（含导航）
  - [ ] 响应式布局
- [ ] API 客户端封装
  - [ ] axios 实例配置
  - [ ] 请求/响应拦截器
  - [ ] Token 自动注入
- [ ] Token 管理
  - [ ] localStorage 读写
  - [ ] Token 过期处理
  - [ ] 自动跳转登录

#### 2. 首页看板（0/4）

- [ ] 页面骨架
  - [ ] 顶部 4 个统计卡片组件
  - [ ] 数据包矩阵组件（8列栅格）
  - [ ] 响应式布局
- [ ] 统计卡片
  - [ ] 数据成本卡片（昨日/今日/本月）
  - [ ] 数据余量卡片（N~O6 显示）
  - [ ] 明码线索量卡片
  - [ ] 采买统计卡片
- [ ] 数据包矩阵
  - [ ] 卡片组件（包名、总数、状态、产值）
  - [ ] 点击进入详情页
  - [ ] 状态标识（拨打中/已结束）
  - [ ] 8列栅格布局
- [ ] 时间筛选器
  - [ ] 日期选择组件（UI）
  - [ ] 本月/自定义切换（UI）
  - [ ] 暂不实现筛选逻辑

#### 3. 数据包详情页（0/4）

- [ ] 页面骨架
  - [ ] 顶部信息区
  - [ ] 任务列表区
  - [ ] 面包屑导航
- [ ] 包信息展示
  - [ ] 左侧：包ID、包名、状态、总数等
  - [ ] 右侧：标签统计（AS1/AS2/AF类）
  - [ ] 卡片布局
- [ ] 任务列表
  - [ ] 表格组件（任务ID、名称、状态、时间）
  - [ ] 表格排序（前端排序）
  - [ ] 分页组件
- [ ] 新建任务面板
  - [ ] 按钮（显示面板）
  - [ ] 表单（任务名、层级、组别、日期）
  - [ ] 表单验证
  - [ ] 提交按钮（UI，暂不提交）

#### 4. 数据包登记表（0/3）

- [ ] 页面骨架
  - [ ] 顶部统计（本月采买总量）
  - [ ] 新建按钮
  - [ ] 列表区域
- [ ] 新建/编辑表单
  - [ ] 表单组件（数据包名称、来源、总数等）
  - [ ] 表单验证（必填、格式校验）
  - [ ] 提交按钮
  - [ ] Modal 或抽屉展示
- [ ] 数据包列表
  - [ ] 表格展示（名称、来源、总数、状态等）
  - [ ] 编辑/删除按钮
  - [ ] 分页
  - [ ] 搜索/筛选（UI）

#### 5. 线索需求计算器（0/4）

- [ ] 页面骨架
  - [ ] 三板块布局
  - [ ] 顶部卡片汇总
- [ ] 业务参数输入区
  - [ ] 平均日接通数输入
  - [ ] 参与级别选择（A / A+B / A+B+C）
  - [ ] 优质区间配置（k值：2-9）
- [ ] 数据剩余展示区
  - [ ] N~O_k 层级剩余展示
  - [ ] 接通率显示
  - [ ] 表格布局
- [ ] 7天模拟表
  - [ ] 人力输入（A/B/C 人数）
  - [ ] 采买输入（仅N层）
  - [ ] 实时计算（基础）
  - [ ] 结果展示（优质线索余量、可支撑天数）

**前端小计**: 0/15 项

---

### 🔧 后端任务（0/18）

#### 1. 项目搭建（0/6）

- [ ] Flask 项目初始化
  - [ ] 创建 app/__init__.py
  - [ ] Flask 应用工厂模式
  - [ ] 蓝图注册
- [ ] SQLAlchemy ORM 配置
  - [ ] 数据库连接配置
  - [ ] 模型基类
  - [ ] 会话管理
- [ ] Flask-Migrate 配置
  - [ ] 初始化 migrations 目录
  - [ ] 配置 alembic
- [ ] CORS 跨域配置
  - [ ] 安装 flask-cors
  - [ ] 配置允许的源
- [ ] JWT 认证配置
  - [ ] 安装 flask-jwt-extended
  - [ ] 配置密钥
  - [ ] Token 生成/验证
- [ ] 错误处理
  - [ ] 全局异常处理器
  - [ ] 统一错误响应格式
  - [ ] 日志配置

#### 2. 数据库模型（0/7）

- [ ] User 模型
  - [ ] 用户名、密码、邮箱等字段
  - [ ] 密码加密（bcrypt）
  - [ ] 创建/更新时间
- [ ] LeadPackage 模型（核心）
  - [ ] 基础信息字段（包ID、包名、来源等）
  - [ ] N~O15 层级字段（15个）
  - [ ] 状态字段
  - [ ] 关联关系（与任务、标签汇总）
- [ ] DialTask 模型
  - [ ] 任务基础信息
  - [ ] 关联数据包
  - [ ] 任务状态
  - [ ] 指标字段（拨出数、接通数等）
- [ ] Call 模型
  - [ ] 通话记录字段
  - [ ] 关联任务
  - [ ] 是否接通、是否成功
- [ ] CallTag 模型
  - [ ] 标签关联表
  - [ ] 关联通话记录
  - [ ] 标签代码（16个标签）
- [ ] PackageTagSummary 模型
  - [ ] 包级标签汇总
  - [ ] AS1/AS2/AF 类字段
  - [ ] 关联数据包
- [ ] MetricsSummary 模型
  - [ ] 日期维度汇总
  - [ ] 成本/产值/毛利字段
  - [ ] 索引优化

#### 3. 认证 API（0/3）

- [ ] POST /api/auth/register
  - [ ] 参数验证（用户名、密码、邮箱）
  - [ ] 用户唯一性检查
  - [ ] 密码加密
  - [ ] 返回用户信息
- [ ] POST /api/auth/login
  - [ ] 参数验证
  - [ ] 用户验证
  - [ ] 生成 JWT Token
  - [ ] 返回 token 和用户信息
- [ ] GET /api/auth/me
  - [ ] JWT 验证装饰器
  - [ ] 返回当前用户信息

#### 4. 数据包 API（0/5）

- [ ] GET /api/packages
  - [ ] 分页参数处理
  - [ ] 筛选参数（状态、来源等）
  - [ ] 返回列表 + 总数
  - [ ] 基础统计信息
- [ ] POST /api/packages
  - [ ] 参数验证
  - [ ] 创建数据包
  - [ ] 返回创建的数据包
- [ ] GET /api/packages/:id
  - [ ] ID 验证
  - [ ] 返回详细信息
  - [ ] 包含标签汇总
- [ ] PUT /api/packages/:id
  - [ ] 参数验证
  - [ ] 更新数据包
  - [ ] 返回更新后的数据
- [ ] DELETE /api/packages/:id
  - [ ] ID 验证
  - [ ] 删除数据包
  - [ ] 级联删除或检查关联

#### 5. 任务 API（0/2）

- [ ] GET /api/packages/:id/tasks
  - [ ] 返回任务列表
  - [ ] 包含基础指标
  - [ ] 倒序排列
- [ ] POST /api/packages/:id/tasks
  - [ ] 参数验证（任务名、层级等）
  - [ ] 唯一性验证（单包仅1个运行任务）
  - [ ] 创建任务记录
  - [ ] 返回任务信息

#### 6. 指标 API（0/2）

- [ ] GET /api/metrics/dashboard
  - [ ] 4 个统计卡片数据
  - [ ] 数据包列表（最近20个）
  - [ ] 基础聚合查询
- [ ] GET /api/metrics/summary
  - [ ] 时间范围参数
  - [ ] 汇总统计
  - [ ] 成本/产值计算

#### 7. 测试数据（0/1）

- [ ] 创建 seed_data.py
  - [ ] 创建默认管理员用户（admin/admin123）
  - [ ] 生成 5-10 个测试数据包
  - [ ] 每个包包含基础字段数据
  - [ ] 部分包包含任务数据

**后端小计**: 0/18 项

---

### ✅ M1 验收标准（0/12）

#### 前端验收（0/6）

- [ ] 4 个页面可访问，无 404 错误
- [ ] 登录注册功能正常
- [ ] 数据包列表能正常显示
- [ ] 能创建新数据包并在列表中显示
- [ ] 页面间导航正常（Header 导航）
- [ ] 样式基本完整，无明显错位（80%完成度）

#### 后端验收（0/4）

- [ ] 数据库表创建成功（7张表）
- [ ] 所有 API 接口可正常调用
- [ ] 返回数据格式统一且正确
- [ ] JWT 认证正常工作

#### 集成验收（0/1）

- [ ] 前后端能正常通信（CORS 正确配置）
- [ ] 创建数据包完整流程可走通
  - 前端填写表单 → 提交 → 后端创建 → 返回 → 前端列表刷新

#### 环境验证（0/1）

- [ ] 本地开发环境稳定运行
  - Backend: http://localhost:5002
  - Frontend: http://localhost:3002
  - 可通过 npm run dev 和 python run.py 启动

**验收小计**: 0/12 项

---

### 📝 M1 开发建议

#### 开发顺序建议

**第一步：后端基础**（1-2天）
1. 项目搭建
2. 数据库模型
3. 认证 API

**第二步：前端基础**（1天）
1. 项目搭建
2. 路由配置
3. 登录页面

**第三步：核心功能**（2-3天）
1. 后端：数据包 API
2. 前端：数据包登记表
3. 前端：首页看板
4. 集成测试

**第四步：其他页面**（2天）
1. 数据包详情页
2. 计算器页面
3. 样式优化

**预计总时长**: 6-8 天

---

### 🚫 M1 不包含的功能

明确 M1 阶段 **不做** 的内容：

- ❌ 外呼平台 API 对接
- ❌ 实时数据回收
- ❌ 复杂的标签统计
- ❌ 动态呼吸动效
- ❌ 高级筛选和搜索
- ❌ OCR 截图识别
- ❌ 报表导出
- ❌ 通知告警
- ❌ 权限管理
- ❌ 审计日志
- ❌ 复杂的计算器算法
- ❌ 生产环境部署

这些功能在 M2-M4 阶段完成。

---

## ⏳ M2：任务逻辑

**目标**: 实现完整的任务创建、执行、回收流程

**状态**: ⏳ 待开始  
**预计开始**: M1 完成后  
**预计工期**: 2-3 周

### 核心功能

#### 1. 任务创建增强（0/4）

- [ ] 任务命名规则引擎
  - [ ] 按 PRD 规则自动生成任务名
  - [ ] 格式：前缀 + 层级 + 话务员组别 + 日期
  - [ ] 可配置命名规则
- [ ] 任务参数配置
  - [ ] 数据层级选择（N/O1/O2...）
  - [ ] 话务员组别选择
  - [ ] 任务日期选择
  - [ ] 任务数量设置
- [ ] 任务唯一性验证
  - [ ] 单包仅允许 1 个运行中任务
  - [ ] 创建前检查
  - [ ] 友好错误提示
- [ ] 任务模板
  - [ ] 常用任务模板保存
  - [ ] 快速创建

#### 2. 外呼平台对接（0/5）

- [ ] API 客户端封装
  - [ ] 创建 `app/integrations/callcenter_api.py`
  - [ ] 请求签名/认证
  - [ ] 重试机制
  - [ ] 错误处理
- [ ] 创建外呼任务
  - [ ] POST /external/callcenter/task/create
  - [ ] 传递任务参数
  - [ ] 返回外部任务ID
  - [ ] 保存映射关系
- [ ] 获取任务状态
  - [ ] GET /external/callcenter/task/list/v3
  - [ ] 定时同步任务状态
  - [ ] 更新本地任务状态
- [ ] 获取通话记录
  - [ ] GET /external/callcenter/task/cdr/all2
  - [ ] 拉取通话明细（CDR）
  - [ ] 解析通话数据
  - [ ] 批量导入本地数据库
- [ ] Webhook 接收
  - [ ] POST /api/webhook/callcenter
  - [ ] 接收任务完成通知
  - [ ] 验证签名
  - [ ] 触发数据回收

#### 3. 数据回收逻辑（0/5）

- [ ] 通话记录导入
  - [ ] 解析 CDR 数据格式
  - [ ] 批量创建 Call 记录
  - [ ] 事务处理
  - [ ] 导入状态记录
- [ ] 标签自动识别
  - [ ] 根据通话结果分配标签
  - [ ] 16 个标签规则实现
  - [ ] 创建 CallTag 记录
  - [ ] 标签优先级处理
- [ ] 任务指标更新
  - [ ] 拨出数统计
  - [ ] 接通数统计
  - [ ] 成功数统计（AS1+AS2）
  - [ ] 自动计算接通率、成功率
- [ ] 包级标签汇总
  - [ ] 汇总 AS1/AS2 数量
  - [ ] 汇总 AF 类（可跟进）数量
  - [ ] 更新 PackageTagSummary 表
  - [ ] 实时更新
- [ ] 层级流转
  - [ ] 统计未接通线索
  - [ ] 流转到下一层（N→O1→O2...）
  - [ ] 更新包的层级数据
  - [ ] 记录流转历史

#### 4. 自动化流程（0/4）

- [ ] 任务完成自动判断
  - [ ] 接通率 ≥ 95%
  - [ ] 或到达 O15 层
  - [ ] 自动标记任务完成
- [ ] 自动关闭任务
  - [ ] 更新任务状态
  - [ ] 生成完成报告
  - [ ] 触发通知
- [ ] 自动生成下一个任务建议
  - [ ] 根据剩余线索
  - [ ] 建议下一层级
  - [ ] 建议任务参数
- [ ] 定时任务
  - [ ] 每小时同步任务状态
  - [ ] 每日汇总统计
  - [ ] 数据清理任务

#### 5. 前端增强（0/3）

- [ ] 任务详情页
  - [ ] 任务执行进度
  - [ ] 实时刷新
  - [ ] 通话记录列表
  - [ ] 标签分布图
- [ ] 任务控制
  - [ ] 暂停/恢复任务
  - [ ] 停止任务
  - [ ] 复拨设置
- [ ] 实时通知
  - [ ] 任务完成通知
  - [ ] 任务异常告警
  - [ ] WebSocket 实时推送

### M2 验收标准（0/8）

- [ ] 可通过前端创建外呼任务到真实外呼平台
- [ ] 任务状态能自动同步（每小时）
- [ ] 通话记录能自动回收
- [ ] 16 个标签能正确识别并分类
- [ ] 标签汇总自动更新（AS1/AS2/AF类）
- [ ] 层级流转逻辑正确（未接通→下一层）
- [ ] 任务完成能自动判断和关闭
- [ ] 完整的任务生命周期可追踪

---

## ⏳ M3：计算器

**目标**: 实现智能的线索需求预测和采买建议

**状态**: ⏳ 待开始  
**预计开始**: M2 完成后  
**预计工期**: 2 周

### 核心功能

#### 1. 供需预测算法（0/5）

- [ ] 优质线索余量计算
  - [ ] N ~ O_k 层级剩余统计
  - [ ] 可配置 k 值（2-9）
  - [ ] 实时计算
  - [ ] 缓存优化
- [ ] 日消耗量预测
  - [ ] 基于人力配置（A/B/C级）
  - [ ] 基于平均接通率
  - [ ] 基于历史消耗数据
  - [ ] 考虑工作日/节假日
- [ ] 可支撑天数计算
  - [ ] 余量 / 日消耗
  - [ ] 考虑采买在途量
  - [ ] 安全库存阈值
- [ ] 采买缺口计算
  - [ ] 目标支撑天数设置
  - [ ] 当前可支撑天数
  - [ ] 缺口量计算
  - [ ] 紧急程度评估
- [ ] 预测准确度分析
  - [ ] 历史预测 vs 实际
  - [ ] 误差率统计
  - [ ] 算法优化建议

#### 2. 7天模拟表（0/4）

- [ ] 人力输入
  - [ ] A/B/C 级话务员人数
  - [ ] 每日人数可配置
  - [ ] 考虑轮休
- [ ] 采买输入
  - [ ] 仅 N 层可采买
  - [ ] 每日采买量输入
  - [ ] 采买到货延迟
- [ ] 每日消耗模拟
  - [ ] 根据人力计算拨打量
  - [ ] 根据接通率计算接通量
  - [ ] 库存扣减
- [ ] 库存优先级流转
  - [ ] N→O1→O2...自动流转
  - [ ] 考虑接通率递减
  - [ ] 实时余量计算

#### 3. 采买策略输出（0/4）

- [ ] 智能采买建议
  - [ ] 建议采买量
  - [ ] 建议采买时机
  - [ ] 分批采买策略
  - [ ] 风险评估
- [ ] 成本效益分析
  - [ ] 单条成本
  - [ ] 预期产值（基于历史成功率）
  - [ ] 预期毛利
  - [ ] ROI 计算
- [ ] 多场景模拟
  - [ ] 乐观/标准/悲观场景
  - [ ] What-if 分析
  - [ ] 敏感度分析
- [ ] 策略导出
  - [ ] 生成采买计划文档
  - [ ] 包含详细数据和图表
  - [ ] PDF/Excel 导出

#### 4. 历史数据对比（0/4）

- [ ] 近 30 天采买趋势
  - [ ] 采买量折线图
  - [ ] 采买成本趋势
  - [ ] 同比/环比
- [ ] 消耗趋势分析
  - [ ] 日均消耗量
  - [ ] 消耗波动分析
  - [ ] 趋势预测
- [ ] 接通率变化
  - [ ] 各层级接通率趋势
  - [ ] 接通率影响因素分析
- [ ] 成功率变化
  - [ ] AS1/AS2 成功率趋势
  - [ ] 行业/来源对比
  - [ ] 优化建议

#### 5. 前端可视化（0/3）

- [ ] 图表集成
  - [ ] 集成 ECharts 或 Recharts
  - [ ] 折线图（趋势）
  - [ ] 柱状图（对比）
  - [ ] 饼图（占比）
- [ ] 交互式模拟
  - [ ] 拖动滑块调整参数
  - [ ] 实时计算并展示结果
  - [ ] 动画过渡
- [ ] 响应式设计
  - [ ] 移动端适配
  - [ ] 图表自适应

### M3 验收标准（0/6）

- [ ] 计算器能准确预测未来 7 天线索需求
- [ ] 7 天模拟结果符合实际业务规则
- [ ] 采买建议合理且可执行
- [ ] 算法经过业务团队验证
- [ ] 预测准确度 ≥ 85%
- [ ] 图表展示清晰美观

---

## ⏳ M4：报表与告警

**目标**: 实现报表导出和智能告警系统

**状态**: ⏳ 待开始  
**预计开始**: M3 完成后  
**预计工期**: 2 周

### 核心功能

#### 1. 报表生成（0/5）

- [ ] 数据成本日报
  - [ ] 昨日/今日/累计成本
  - [ ] 同比/环比分析
  - [ ] Excel 导出
  - [ ] 自动发送邮件
- [ ] 成功单产值报表
  - [ ] AS1/AS2 分类统计
  - [ ] 按来源/行业分组
  - [ ] 毛利计算
  - [ ] 图表展示
- [ ] 明码线索统计
  - [ ] AF 类标签汇总
  - [ ] 可跟进线索列表
  - [ ] 按数据包分组
  - [ ] 导出联系方式（权限控制）
- [ ] 供需预测报告
  - [ ] 7 天需求预测
  - [ ] 采买建议
  - [ ] 图表可视化
  - [ ] PDF 导出
- [ ] 月度经营报告
  - [ ] 完整的财务数据
  - [ ] 多维度分析
  - [ ] 趋势对比
  - [ ] Executive Summary

#### 2. 告警系统（0/4）

- [ ] 库存预警
  - [ ] 优质线索不足 3 天
  - [ ] 某层级库存为 0
  - [ ] 自动发送通知
  - [ ] 预警等级（提醒/警告/紧急）
- [ ] 成本告警
  - [ ] 月度成本超预算（百分比阈值）
  - [ ] 单日成本异常（±3σ）
  - [ ] 实时监控
  - [ ] 可配置阈值
- [ ] 任务异常告警
  - [ ] 任务卡住超 24 小时
  - [ ] 接通率异常偏低（< 5%）
  - [ ] 任务失败
  - [ ] 数据回收失败
- [ ] 采买提醒
  - [ ] 建议采买时机
  - [ ] 预算不足提醒
  - [ ] 采买计划到期提醒

#### 3. 通知渠道（0/3）

- [ ] 邮件通知
  - [ ] SMTP 配置
  - [ ] 邮件模板
  - [ ] 附件支持
  - [ ] 批量发送
- [ ] 企业微信/钉钉通知
  - [ ] Webhook 集成
  - [ ] Markdown 格式
  - [ ] @特定人员
  - [ ] 卡片消息
- [ ] 站内消息
  - [ ] 消息中心
  - [ ] 未读提醒
  - [ ] 消息已读状态
  - [ ] 消息分类

#### 4. 审计日志（0/3）

- [ ] 操作记录
  - [ ] 数据包创建/修改/删除
  - [ ] 任务创建/停止/复拨
  - [ ] 记录操作人、时间、内容
  - [ ] IP 地址记录
- [ ] 导出记录
  - [ ] 报表导出记录
  - [ ] 明码线索导出记录
  - [ ] 敏感操作审计
  - [ ] 可追溯性
- [ ] 日志查询
  - [ ] 按时间/用户/操作类型筛选
  - [ ] 日志详情查看
  - [ ] 日志导出

#### 5. 前端展示（0/3）

- [ ] 报表中心页面
  - [ ] 报表列表
  - [ ] 在线预览
  - [ ] 下载管理
  - [ ] 定时任务配置
- [ ] 通知中心页面
  - [ ] 通知列表
  - [ ] 未读标记
  - [ ] 通知详情
  - [ ] 通知设置
- [ ] 审计日志页面
  - [ ] 日志列表
  - [ ] 高级筛选
  - [ ] 日志详情
  - [ ] 统计分析

### M4 验收标准（0/7）

- [ ] 所有报表能正常生成和导出
- [ ] 报表数据准确无误
- [ ] 告警及时准确（延迟 < 5 分钟）
- [ ] 通知渠道稳定可靠
- [ ] 审计日志完整无遗漏
- [ ] 敏感操作有权限控制
- [ ] 用户反馈良好

---

## 📅 总体时间规划

```
M0: Figma 低保真     ████████████████████  ✅ 已完成 (2025-01-18)

M1: Cursor 骨架      ░░░░░░░░░░░░░░░░░░░░  ⏳ 6-8天
    ├─ 后端基础: 2天
    ├─ 前端基础: 1天
    ├─ 核心功能: 3天
    └─ 其他页面: 2天

M2: 任务逻辑        ░░░░░░░░░░░░░░░░░░░░  ⏳ 2-3周
    ├─ 任务创建: 3天
    ├─ API对接: 5天
    ├─ 数据回收: 4天
    └─ 自动化: 3天

M3: 计算器          ░░░░░░░░░░░░░░░░░░░░  ⏳ 2周
    ├─ 预测算法: 5天
    ├─ 7天模拟: 3天
    ├─ 采买策略: 3天
    └─ 历史对比: 3天

M4: 报表与告警      ░░░░░░░░░░░░░░░░░░░░  ⏳ 2周
    ├─ 报表生成: 5天
    ├─ 告警系统: 3天
    ├─ 通知渠道: 3天
    └─ 审计日志: 3天

预计总工期: 7-9 周
```

---

## 🎯 关键决策点

### 1. 数据库选择
- **当前**: SQLite（开发环境）
- **M1 结束前决策**: 是否切换到 PostgreSQL
- **建议**: M1 完成后立即迁移，避免 M2 阶段数据丢失

### 2. 外呼平台 API
- **关键**: 获取 API 文档和测试环境
- **时机**: M1 结束前联系外呼平台提供商
- **风险**: API 对接可能遇到兼容性问题

### 3. OCR 服务
- **选项 A**: 百度 OCR（商业，效果好，每月有免费额度）
- **选项 B**: Tesseract（开源，免费，效果一般）
- **建议**: M2 阶段先试 Tesseract，效果不好再上商业服务

### 4. 报表工具
- **选项 A**: openpyxl（Excel）+ ReportLab（PDF）
- **选项 B**: Pandas + Matplotlib
- **建议**: 选 A，更灵活，格式控制更好

---

## 📝 文档维护

### 更新规则

1. **每完成一个任务，立即更新**
   - 将 `[ ]` 改为 `[x]`
   - 更新进度百分比
   - 记录完成时间

2. **每个阶段完成时**
   - 更新阶段状态（🔄 → ✅）
   - 记录实际完成时间
   - 总结经验和问题

3. **遇到重大变更时**
   - 记录变更原因
   - 调整后续计划
   - 更新文档版本号

### 进度汇报

**建议频率**:
- M1 阶段：每 2 天更新一次
- M2-M4 阶段：每周更新一次

**汇报内容**:
- 已完成任务
- 进行中任务
- 遇到的问题
- 下一步计划

---

## 🔗 相关文档

- 📄 [产品需求文档（PRD）](./PRD.md)
- 📄 [API 接口文档](./API.md) - 待创建
- 📄 [数据库设计文档](./DATABASE.md) - 待创建
- 📄 [部署文档](./DEPLOYMENT.md) - 待创建
- 🌐 [生产环境](https://call-center-frontend.zeabur.app)
- 📚 [文档仓库](https://github.com/call-center-org/call-center-docs)

---

## 📞 问题反馈

**遇到问题时**:
1. 先查看 PRD 文档确认需求
2. 检查本文档的验收标准
3. 在项目仓库提 Issue
4. 团队讨论解决方案

---

**文档维护者**: Tom & AI Assistant  
**创建时间**: 2025-01-18  
**最后更新**: 2025-01-18  
**文档版本**: 1.0

